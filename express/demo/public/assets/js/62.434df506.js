(window.webpackJsonp=window.webpackJsonp||[]).push([[62],{272:function(e,s,t){"use strict";t.r(s);var a=t(28),n=Object(a.a)({},(function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h4",{attrs:{id:"撤销修改"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#撤销修改"}},[e._v("#")]),e._v(" 撤销修改")]),e._v(" "),t("hr"),e._v(" "),t("p",[e._v("自然，你是不会犯错的。不过现在是凌晨两点，你正在赶一份工作报告，你在"),t("code",[e._v("readme.txt")]),e._v("中添加了一行：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("$ cat readme.txt\nGit is a distributed version control system.\nGit is free software distributed under the GPL.\nGit has a mutable index called stage.\nGit tracks changes of files.\nMy stupid boss still prefers SVN.\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br")])]),t("p",[e._v("在你准备提交前，一杯咖啡起了作用，你猛然发现了"),t("code",[e._v("stupid boss")]),e._v("可能会让你丢掉这个月的奖金！")]),e._v(" "),t("p",[e._v("既然错误发现得很及时，就可以很容易地纠正它。你可以删掉最后一行，手动把文件恢复到上一个版本的状态。如果用"),t("code",[e._v("git status")]),e._v("查看一下：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('$ git status\nOn branch master\nChanges not staged for commit:\n  (use "git add <file>..." to update what will be committed)\n  (use "git checkout -- <file>..." to discard changes in working directory)\n\n\tmodified:   readme.txt\n\nno changes added to commit (use "git add" and/or "git commit -a")\n')])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br"),t("span",{staticClass:"line-number"},[e._v("7")]),t("br"),t("span",{staticClass:"line-number"},[e._v("8")]),t("br"),t("span",{staticClass:"line-number"},[e._v("9")]),t("br")])]),t("p",[e._v("你可以发现，Git会告诉你，"),t("code",[e._v("git checkout -- file")]),e._v("可以丢弃工作区的修改：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("$ git checkout -- readme.txt\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("命令"),t("code",[e._v("git checkout -- readme.txt")]),e._v("意思就是，把"),t("code",[e._v("readme.txt")]),e._v("文件在工作区的修改全部撤销，这里有两种情况：")]),e._v(" "),t("p",[e._v("一种是"),t("code",[e._v("readme.txt")]),e._v("自修改后还没有被放到暂存区，现在，撤销修改就回到和版本库一模一样的状态；")]),e._v(" "),t("p",[e._v("一种是"),t("code",[e._v("readme.txt")]),e._v("已经添加到暂存区后，又作了修改，现在，撤销修改就回到添加到暂存区后的状态。")]),e._v(" "),t("p",[e._v("总之，就是让这个文件回到最近一次"),t("code",[e._v("git commit")]),e._v("或"),t("code",[e._v("git add")]),e._v("时的状态。")]),e._v(" "),t("p",[e._v("现在，看看"),t("code",[e._v("readme.txt")]),e._v("的文件内容：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("$ cat readme.txt\nGit is a distributed version control system.\nGit is free software distributed under the GPL.\nGit has a mutable index called stage.\nGit tracks changes of files.\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br")])]),t("p",[e._v("文件内容果然复原了。")]),e._v(" "),t("p",[t("code",[e._v("git checkout -- file")]),e._v("命令中的"),t("code",[e._v("--")]),e._v("很重要，没有"),t("code",[e._v("--")]),e._v("，就变成了“切换到另一个分支”的命令，我们在后面的分支管理中会再次遇到"),t("code",[e._v("git checkout")]),e._v("命令。")]),e._v(" "),t("p",[e._v("现在假定是凌晨3点，你不但写了一些胡话，还"),t("code",[e._v("git add")]),e._v("到暂存区了：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("$ cat readme.txt\nGit is a distributed version control system.\nGit is free software distributed under the GPL.\nGit has a mutable index called stage.\nGit tracks changes of files.\nMy stupid boss still prefers SVN.\n\n$ git add readme.txt\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br"),t("span",{staticClass:"line-number"},[e._v("7")]),t("br"),t("span",{staticClass:"line-number"},[e._v("8")]),t("br")])]),t("p",[e._v("庆幸的是，在"),t("code",[e._v("commit")]),e._v("之前，你发现了这个问题。用"),t("code",[e._v("git status")]),e._v("查看一下，修改只是添加到了暂存区，还没有提交：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('$ git status\nOn branch master\nChanges to be committed:\n  (use "git reset HEAD <file>..." to unstage)\n\n\tmodified:   readme.txt\n')])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br")])]),t("p",[e._v("Git同样告诉我们，用命令"),t("code",[e._v("git reset HEAD")]),e._v("可以把暂存区的修改撤销掉（unstage），重新放回工作区：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("$ git reset HEAD readme.txt\nUnstaged changes after reset:\nM\treadme.txt\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br")])]),t("p",[t("code",[e._v("git reset")]),e._v("命令既可以回退版本，也可以把暂存区的修改回退到工作区。当我们用"),t("code",[e._v("HEAD")]),e._v("时，表示最新的版本。")]),e._v(" "),t("p",[e._v("再用"),t("code",[e._v("git status")]),e._v("查看一下，现在暂存区是干净的，工作区有修改：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('$ git status\nOn branch master\nChanges not staged for commit:\n  (use "git add <file>..." to update what will be committed)\n  (use "git checkout -- <file>..." to discard changes in working directory)\n\n\tmodified:   readme.txt\n')])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br"),t("span",{staticClass:"line-number"},[e._v("7")]),t("br")])]),t("p",[e._v("还记得如何丢弃工作区的修改吗？")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("$ git checkout -- readme.txt\n\n$ git status\nOn branch master\nnothing to commit, working tree clean\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br")])]),t("p",[e._v("整个世界终于清静了！")]),e._v(" "),t("p",[e._v("现在，假设你不但改错了东西，还从暂存区提交到了版本库，怎么办呢？还记得"),t("a",{attrs:{href:"https://www.liaoxuefeng.com/wiki/896043488029600/897013573512192",target:"_blank",rel:"noopener noreferrer"}},[e._v("版本回退"),t("OutboundLink")],1),e._v("一节吗？可以回退到上一个版本。不过，这是有条件的，就是你还没有把自己的本地版本库推送到远程。还记得Git是分布式版本控制系统吗？我们后面会讲到远程版本库，一旦你把"),t("code",[e._v("stupid boss")]),e._v("提交推送到远程版本库，你就真的惨了……")]),e._v(" "),t("h3",{attrs:{id:"小结"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#小结"}},[e._v("#")]),e._v(" 小结")]),e._v(" "),t("p",[e._v("又到了小结时间。")]),e._v(" "),t("p",[e._v("场景1：当你改乱了工作区某个文件的内容，想直接丢弃工作区的修改时，用命令"),t("code",[e._v("git checkout -- file")]),e._v("。")]),e._v(" "),t("p",[e._v("场景2：当你不但改乱了工作区某个文件的内容，还添加到了暂存区时，想丢弃修改，分两步，第一步用命令"),t("code",[e._v("git reset HEAD")]),e._v("，就回到了场景1，第二步按场景1操作。")]),e._v(" "),t("p",[e._v("场景3：已经提交了不合适的修改到版本库时，想要撤销本次提交，参考"),t("a",{attrs:{href:"https://www.liaoxuefeng.com/wiki/896043488029600/897013573512192",target:"_blank",rel:"noopener noreferrer"}},[e._v("版本回退"),t("OutboundLink")],1),e._v("一节，不过前提是没有推送到远程库。")])])}),[],!1,null,null,null);s.default=n.exports}}]);