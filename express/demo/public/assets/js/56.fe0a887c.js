(window.webpackJsonp=window.webpackJsonp||[]).push([[56],{279:function(e,t,v){"use strict";v.r(t);var s=v(28),a=Object(s.a)({},(function(){var e=this,t=e.$createElement,v=e._self._c||t;return v("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[v("h4",{attrs:{id:"创建与合并分支"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#创建与合并分支"}},[e._v("#")]),e._v(" 创建与合并分支")]),e._v(" "),v("hr"),e._v(" "),v("p",[e._v("在"),v("a",{attrs:{href:"https://www.liaoxuefeng.com/wiki/896043488029600/897013573512192",target:"_blank",rel:"noopener noreferrer"}},[e._v("版本回退"),v("OutboundLink")],1),e._v("里，你已经知道，每次提交，Git都把它们串成一条时间线，这条时间线就是一个分支。截止到目前，只有一条时间线，在Git里，这个分支叫主分支，即"),v("code",[e._v("master")]),e._v("分支。"),v("code",[e._v("HEAD")]),e._v("严格来说不是指向提交，而是指向"),v("code",[e._v("master")]),e._v("，"),v("code",[e._v("master")]),e._v("才是指向提交的，所以，"),v("code",[e._v("HEAD")]),e._v("指向的就是当前分支。")]),e._v(" "),v("p",[e._v("一开始的时候，"),v("code",[e._v("master")]),e._v("分支是一条线，Git用"),v("code",[e._v("master")]),e._v("指向最新的提交，再用"),v("code",[e._v("HEAD")]),e._v("指向"),v("code",[e._v("master")]),e._v("，就能确定当前分支，以及当前分支的提交点：")]),e._v(" "),v("p",[v("img",{attrs:{src:"https://www.liaoxuefeng.com/files/attachments/919022325462368/0",alt:"git-br-initial"}})]),e._v(" "),v("p",[e._v("每次提交，"),v("code",[e._v("master")]),e._v("分支都会向前移动一步，这样，随着你不断提交，"),v("code",[e._v("master")]),e._v("分支的线也越来越长。")]),e._v(" "),v("p",[e._v("当我们创建新的分支，例如"),v("code",[e._v("dev")]),e._v("时，Git新建了一个指针叫"),v("code",[e._v("dev")]),e._v("，指向"),v("code",[e._v("master")]),e._v("相同的提交，再把"),v("code",[e._v("HEAD")]),e._v("指向"),v("code",[e._v("dev")]),e._v("，就表示当前分支在"),v("code",[e._v("dev")]),e._v("上：")]),e._v(" "),v("p",[v("img",{attrs:{src:"https://www.liaoxuefeng.com/files/attachments/919022363210080/l",alt:"git-br-create"}})]),e._v(" "),v("p",[e._v("你看，Git创建一个分支很快，因为除了增加一个"),v("code",[e._v("dev")]),e._v("指针，改改"),v("code",[e._v("HEAD")]),e._v("的指向，工作区的文件都没有任何变化！")]),e._v(" "),v("p",[e._v("不过，从现在开始，对工作区的修改和提交就是针对"),v("code",[e._v("dev")]),e._v("分支了，比如新提交一次后，"),v("code",[e._v("dev")]),e._v("指针往前移动一步，而"),v("code",[e._v("master")]),e._v("指针不变：")]),e._v(" "),v("p",[v("img",{attrs:{src:"https://www.liaoxuefeng.com/files/attachments/919022387118368/l",alt:"git-br-dev-fd"}})]),e._v(" "),v("p",[e._v("假如我们在"),v("code",[e._v("dev")]),e._v("上的工作完成了，就可以把"),v("code",[e._v("dev")]),e._v("合并到"),v("code",[e._v("master")]),e._v("上。Git怎么合并呢？最简单的方法，就是直接把"),v("code",[e._v("master")]),e._v("指向"),v("code",[e._v("dev")]),e._v("的当前提交，就完成了合并：")]),e._v(" "),v("p",[v("img",{attrs:{src:"https://www.liaoxuefeng.com/files/attachments/919022412005504/0",alt:"git-br-ff-merge"}})]),e._v(" "),v("p",[e._v("所以Git合并分支也很快！就改改指针，工作区内容也不变！")]),e._v(" "),v("p",[e._v("合并完分支后，甚至可以删除"),v("code",[e._v("dev")]),e._v("分支。删除"),v("code",[e._v("dev")]),e._v("分支就是把"),v("code",[e._v("dev")]),e._v("指针给删掉，删掉后，我们就剩下了一条"),v("code",[e._v("master")]),e._v("分支：")]),e._v(" "),v("p",[v("img",{attrs:{src:"https://www.liaoxuefeng.com/files/attachments/919022479428512/0",alt:"git-br-rm"}})]),e._v(" "),v("p",[e._v("真是太神奇了，你看得出来有些提交是通过分支完成的吗？")]),e._v(" "),v("p",[e._v("下面开始实战。")]),e._v(" "),v("p",[e._v("首先，我们创建"),v("code",[e._v("dev")]),e._v("分支，然后切换到"),v("code",[e._v("dev")]),e._v("分支：")]),e._v(" "),v("div",{staticClass:"language- line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[e._v("$ git checkout -b dev\nSwitched to a new branch 'dev'\n")])]),e._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[e._v("1")]),v("br"),v("span",{staticClass:"line-number"},[e._v("2")]),v("br")])]),v("p",[v("code",[e._v("git checkout")]),e._v("命令加上"),v("code",[e._v("-b")]),e._v("参数表示创建并切换，相当于以下两条命令：")]),e._v(" "),v("div",{staticClass:"language- line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[e._v("$ git branch dev\n$ git checkout dev\nSwitched to branch 'dev'\n")])]),e._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[e._v("1")]),v("br"),v("span",{staticClass:"line-number"},[e._v("2")]),v("br"),v("span",{staticClass:"line-number"},[e._v("3")]),v("br")])]),v("p",[e._v("然后，用"),v("code",[e._v("git branch")]),e._v("命令查看当前分支：")]),e._v(" "),v("div",{staticClass:"language- line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[e._v("$ git branch\n* dev\n  master\n")])]),e._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[e._v("1")]),v("br"),v("span",{staticClass:"line-number"},[e._v("2")]),v("br"),v("span",{staticClass:"line-number"},[e._v("3")]),v("br")])]),v("p",[v("code",[e._v("git branch")]),e._v("命令会列出所有分支，当前分支前面会标一个"),v("code",[e._v("*")]),e._v("号。")]),e._v(" "),v("p",[e._v("然后，我们就可以在"),v("code",[e._v("dev")]),e._v("分支上正常提交，比如对"),v("code",[e._v("readme.txt")]),e._v("做个修改，加上一行：")]),e._v(" "),v("div",{staticClass:"language- line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[e._v("Creating a new branch is quick.\n")])]),e._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[e._v("1")]),v("br")])]),v("p",[e._v("然后提交：")]),e._v(" "),v("div",{staticClass:"language- line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[e._v('$ git add readme.txt \n$ git commit -m "branch test"\n[dev b17d20e] branch test\n 1 file changed, 1 insertion(+)\n')])]),e._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[e._v("1")]),v("br"),v("span",{staticClass:"line-number"},[e._v("2")]),v("br"),v("span",{staticClass:"line-number"},[e._v("3")]),v("br"),v("span",{staticClass:"line-number"},[e._v("4")]),v("br")])]),v("p",[e._v("现在，"),v("code",[e._v("dev")]),e._v("分支的工作完成，我们就可以切换回"),v("code",[e._v("master")]),e._v("分支：")]),e._v(" "),v("div",{staticClass:"language- line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[e._v("$ git checkout master\nSwitched to branch 'master'\n")])]),e._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[e._v("1")]),v("br"),v("span",{staticClass:"line-number"},[e._v("2")]),v("br")])]),v("p",[e._v("切换回"),v("code",[e._v("master")]),e._v("分支后，再查看一个"),v("code",[e._v("readme.txt")]),e._v("文件，刚才添加的内容不见了！因为那个提交是在"),v("code",[e._v("dev")]),e._v("分支上，而"),v("code",[e._v("master")]),e._v("分支此刻的提交点并没有变：")]),e._v(" "),v("p",[v("img",{attrs:{src:"https://www.liaoxuefeng.com/files/attachments/919022533080576/0",alt:"git-br-on-master"}})]),e._v(" "),v("p",[e._v("现在，我们把"),v("code",[e._v("dev")]),e._v("分支的工作成果合并到"),v("code",[e._v("master")]),e._v("分支上：")]),e._v(" "),v("div",{staticClass:"language- line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[e._v("$ git merge dev\nUpdating d46f35e..b17d20e\nFast-forward\n readme.txt | 1 +\n 1 file changed, 1 insertion(+)\n")])]),e._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[e._v("1")]),v("br"),v("span",{staticClass:"line-number"},[e._v("2")]),v("br"),v("span",{staticClass:"line-number"},[e._v("3")]),v("br"),v("span",{staticClass:"line-number"},[e._v("4")]),v("br"),v("span",{staticClass:"line-number"},[e._v("5")]),v("br")])]),v("p",[v("code",[e._v("git merge")]),e._v("命令用于合并指定分支到当前分支。合并后，再查看"),v("code",[e._v("readme.txt")]),e._v("的内容，就可以看到，和"),v("code",[e._v("dev")]),e._v("分支的最新提交是完全一样的。")]),e._v(" "),v("p",[e._v("注意到上面的"),v("code",[e._v("Fast-forward")]),e._v("信息，Git告诉我们，这次合并是“快进模式”，也就是直接把"),v("code",[e._v("master")]),e._v("指向"),v("code",[e._v("dev")]),e._v("的当前提交，所以合并速度非常快。")]),e._v(" "),v("p",[e._v("当然，也不是每次合并都能"),v("code",[e._v("Fast-forward")]),e._v("，我们后面会讲其他方式的合并。")]),e._v(" "),v("p",[e._v("合并完成后，就可以放心地删除"),v("code",[e._v("dev")]),e._v("分支了：")]),e._v(" "),v("div",{staticClass:"language- line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[e._v("$ git branch -d dev\nDeleted branch dev (was b17d20e).\n")])]),e._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[e._v("1")]),v("br"),v("span",{staticClass:"line-number"},[e._v("2")]),v("br")])]),v("p",[e._v("删除后，查看"),v("code",[e._v("branch")]),e._v("，就只剩下"),v("code",[e._v("master")]),e._v("分支了：")]),e._v(" "),v("div",{staticClass:"language- line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[e._v("$ git branch\n* master\n")])]),e._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[e._v("1")]),v("br"),v("span",{staticClass:"line-number"},[e._v("2")]),v("br")])]),v("p",[e._v("因为创建、合并和删除分支非常快，所以Git鼓励你使用分支完成某个任务，合并后再删掉分支，这和直接在"),v("code",[e._v("master")]),e._v("分支上工作效果是一样的，但过程更安全。")]),e._v(" "),v("h3",{attrs:{id:"switch"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#switch"}},[e._v("#")]),e._v(" switch")]),e._v(" "),v("p",[e._v("我们注意到切换分支使用"),v("code",[e._v("git checkout")]),e._v("，而前面讲过的撤销修改则是"),v("code",[e._v("git checkout --")]),e._v("，同一个命令，有两种作用，确实有点令人迷惑。")]),e._v(" "),v("p",[e._v("实际上，切换分支这个动作，用"),v("code",[e._v("switch")]),e._v("更科学。因此，最新版本的Git提供了新的"),v("code",[e._v("git switch")]),e._v("命令来切换分支：")]),e._v(" "),v("p",[e._v("创建并切换到新的"),v("code",[e._v("dev")]),e._v("分支，可以使用：")]),e._v(" "),v("div",{staticClass:"language- line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[e._v("$ git switch -c dev\n")])]),e._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[e._v("1")]),v("br")])]),v("p",[e._v("直接切换到已有的"),v("code",[e._v("master")]),e._v("分支，可以使用：")]),e._v(" "),v("div",{staticClass:"language- line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[e._v("$ git switch master\n")])]),e._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[e._v("1")]),v("br")])]),v("p",[e._v("使用新的"),v("code",[e._v("git switch")]),e._v("命令，比"),v("code",[e._v("git checkout")]),e._v("要更容易理解。")]),e._v(" "),v("h3",{attrs:{id:"小结"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#小结"}},[e._v("#")]),e._v(" 小结")]),e._v(" "),v("p",[e._v("Git鼓励大量使用分支：")]),e._v(" "),v("p",[e._v("查看分支："),v("code",[e._v("git branch")])]),e._v(" "),v("p",[e._v("创建分支："),v("code",[e._v("git branch")])]),e._v(" "),v("p",[e._v("切换分支："),v("code",[e._v("git checkout")]),e._v("或者"),v("code",[e._v("git switch")])]),e._v(" "),v("p",[e._v("创建+切换分支："),v("code",[e._v("git checkout -b")]),e._v("或者"),v("code",[e._v("git switch -c")])]),e._v(" "),v("p",[e._v("合并某分支到当前分支："),v("code",[e._v("git merge")])]),e._v(" "),v("p",[e._v("删除分支："),v("code",[e._v("git branch -d")])])])}),[],!1,null,null,null);t.default=a.exports}}]);